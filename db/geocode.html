<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.23.0/axios.min.js"></script>
  <title>Geocoder testing</title>
</head>

<body>

  <form id='search-query' class='search-query'>
    <input id='search-input'>
    <button type='submit'>Search</button>
  </form>

  <div id='formatted_address'> </div>
  <div id='components'> </div>
  <div id='geometry'></div>

  <script>

    const geocoder = function (e) {
      e.preventDefault();

      const location = document.getElementById('search-input').value;
      axios.get('https://maps.googleapis.com/maps/api/geocode/json', {
        params: {
          address: location,
          key: 'AIzaSyCloL_uI_F9x3edJ_zViI7qC5zoq9u2HZg'
        }
      })
        .then(res => {
          console.log(res);

          //formatted address:
          const formattedAddress = res.data.results[0].formatted_address;
          const outputAddress = `
            <class="list">
          <li>${formattedAddress}</li>
           </class>`;

          //loop through address components
          const addressComponents = res.data.results[0].address_components;
          let componentsOutput = `
             <class="list">
          <li>${addressComponents[0].types[0]}: ${addressComponents[0].long_name}</li>
          <li>${addressComponents[1].types[0]}: ${addressComponents[1].long_name}</li>
          <li>${addressComponents[3].types[0]}: ${addressComponents[3].long_name}</li>
          <li>${addressComponents[5].types[0]}: ${addressComponents[5].long_name}</li>
          <li>${addressComponents[6].types[0]}: ${addressComponents[6].long_name}</li>
          <li>${addressComponents[7].types[0]}: ${addressComponents[7].long_name}</li>
             </class>`;



          // for (var i = 0; i < addressComponents.length; i++) {
          //     componentsOutput += `<li>${addressComponents[i].types[0]}: ${addressComponents[i].long_name}</li>`
          // }
          // componentsOutput += '</class>';


          //lat-long
          const lat = res.data.results[0].geometry.location.lat;
          const lng = res.data.results[0].geometry.location.lng;
          const geometryOutput = `<li>Latitude: ${lat}</li><li>Longitude: ${lng}</li>`;

          //outputs to browser
          document.getElementById('formatted_address').innerHTML = outputAddress;
          document.getElementById('components').innerHTML = componentsOutput;
          document.getElementById('geometry').innerHTML = geometryOutput;
        })
        .catch(error => {
          console.log(error)
        });
    };

    const searchQuery = document.getElementById('search-query');
    searchQuery.addEventListener('submit', geocoder);

  </script>

</body>

</html>
